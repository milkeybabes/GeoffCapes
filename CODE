PARAM:	STA PATEM	TYA	PHA		LDY PATEM		LDA NBTAB,Y	STA NB9  	LDA NBH1TAB,Y	STA NBH1	LDA NBH2TAB,Y	STA NBH9	LDA NBH3TAB,Y	STA NBV19 	TYA	ASL A	TAY	LDA LOTAB,Y	STA SPOIL	LDA LOTAB+1,Y	STA SPOIH	LDA #255	STA IMAY	LDA #0	STA FLOP	STA UPSIDESDATA:	LDA #S_DATA	STA STPIX-1 	PLA	TAY	RTSSBACK:	PHA	LDA #0	JMP S_STARTIMAGE:	PHA	LDA #2	JMP S_STARTIMEOR:	PHA	LDA #3S_START:	STA status	PLA	STA TC	STX T3	STY T1	JSR RGSV	JSR SPRITE	JMP RGLDBACK:	JSR RGSV	STX T3	STY T1	LDA #0	STA &76	LDA #s_data	STA &77	LDA #1	STA status	JSR XY	JSR SP	JMP RGLD	 	;"CALC. DATA POS."SPRITE:	LDA T1	SEC	SBC UPSIDE	STA T1	LDA SPOIL	STA &74	LDA SPOIH	STA &75 	LDY TC	LDX NB9	JSR MULADD   	LDA &74	STA &76	LDA &75	STA &77	JSR XY	JMP SP	 	;"CALCULATE XY INTO MEM POSITION "		; " T3-X T1 -Y"XY:	LDA UPSIDE	BEQ XY1	LDA T1	CLC	ADC NBV19	STA T1 	BCC XY1	LDA #255	STA T1XY1:	LDA T3	; X CORDINATE	STA &74	LDA #0	STA &75 	ASL &74	; (X * 8)	ROL &75	ASL &74	ROL &75	ASL &74	ROL &75		LDA T1	; Y CORDINATE	STA IMAY1	LSR A	; (Y DIV 8)	LSR A	LSR A	TAY 	LDA M320L,Y	; * 320	CLC	ADC &74	STA &74	LDA M320H,Y	ADC &75	STA &75	LDA T1	AND #7	; (Y MOD 8)	STA T5	RTSSP:	 	;"PLOT SPRITE &76-DATA &74-SCREEN"	LDA #0	STA T1 	LDX #0L2:	LDA T5	CLC	ADC #8	STA T0	LDA T1	CLC	ADC NBH1	STA FLIP	LDA #0 	STA UDST2L1:	LDY T1	LDA (&76),Y	STA &78   	LDA FLOP	BEQ GT1 	LDA FLIP	TAY 	LDA (&76),Y	TAY	LDA REVERSE,Y	STA &78	DEC FLIPGT1:	LDA status	BNE NOT_SBACK 	LDY T0	; SBACK	LDA (&74),Y	LDY T1	STA &400,YSTPIX:	LDA &78	ASL A	ADC #0	ASL A	ADC #0	ASL A	ADC #0	ASL A	ADC #0	ORA &78	EOR #255	LDY T0	AND (&74),Y	ORA &78	STA (&74),Y 	JMP SSNOT_SBACK:	CMP #3	BEQ S_IMEOR	LDA &78	; (1 & 2) BACK & IMAGE	LDY T0	STA (&74),Y 	JMP SSS_IMEOR: 	LDA &78	; IMEOR	LDY T0	EOR (&74),Y	STA (&74),YSS:	INC T1 	LDA T0	CLC	ADC #8	STA T0	CMP NBH9	BCS NL1	JMP L1 NL1:	LDA UPSIDE	BNE SPUP	INC T5	LDA T5	CMP #8	BNE OK 	LDA #0	STA T5	TAY	LDA &74	CLC	ADC #&40	STA &74	LDA &75	ADC #1	STA &75 OK:	INC IMAY1	INX	CPX NBV19	BEQ DONE	LDA IMAY1	CMP IMAY	BCS DONE	JMP L2DONE: 	RTSSPUP:	DEC T5	LDA T5	CMP #255	BNE OK	LDA #7	STA T5	TAY	LDA &74	SEC	SBC #&40	STA &74	LDA &75	SBC #1	STA &75 	JMP OK	RTSBLOCK:	JSR RGSV	PHA	TXA	PHA	TYA	PHA 	LDA #0	JSR PARAM	JSR RGLD	PHA	TYA	ASL A	ASL A	ASL A	TAY	PLA	DEX		JSR SBACK	PLA	TAY	PLA	TAX	PLA	RTS  BLOCKD:	JSR RGSV	PHA	TXA	PHA	TYA	PHA	LDA #0	JSR PARAM	JSR RGLD	PHA	TYA	ASL A	ASL A	ASL A	TAY	PLA	DEX		JSR IMAGE	PLA	TAY	PLA	TAX	PLA	RTS  RGSV:	STA &90	STX &91	STY &92	RTSRGLD:	LDA &90 	LDX &91	LDY &92	RTSBOX:	 	; BOXP  X Y XL YL CHR (A)	JSR BXPAR	JMP BXPBXPAR:	LDA BOXP	CLC	ADC #10	STA BOXP+5	LDA BOXP+2	STA BXL	LDA BOXP+3	STA BYL	STA BOXP+4	LDA BOXP+2	ASL A	STA BOXP+6	LDA BOXP+5	STA BX	CLC	ADC BOXP+6	STA BX1 	LDA BOXP+1	STA BY	CLC	ADC BOXP+4	STA BY1  	RTSBXP:	LDA #0	STA ALTAB+4	LDX BX	INX	LDY BY	LDA BXL	JSR ALONG  	LDA #0	STA ALTAB+4 	LDX BX	INX	LDY BY1	LDA BXL	JSR ALONG 	LDA #1	STA ALTAB+4	LDX BX	LDY BY	INY	LDA BYL	SEC	SBC #1	JSR DOWN 	LDA #1	STA ALTAB+4 	LDX BX1	LDY BY	INY	LDA BYL	SEC	SBC #1	JSR DOWN 	LDX BX	LDY BY	LDA #3	JSR BLOCKD	LDX BX1	LDY BY	LDA #2	JSR BLOCKD	LDX BX	LDY BY1	LDA #4	JSR BLOCKD	LDX BX1	LDY BY1	LDA #5	JSR BLOCKD	RTSBOX2:	PLA	STA &70	; low byte	PLA		STA &71	; high byte	LDY #1	LDX #0MO_PA:	LDA (&70),Y	STA BOXP,X	INX	CPX #5	BEQ Zstop		INC &70	BNE MO_PA	INC &71	BNE MO_PAZstop:	LDA &71	PHA	LDA &70	PHA	JMP BOX				ALDO:	LDA #0	STA ALTAB+3AL1:	LDX ALTAB+1	LDY ALTAB+2		LDA ALTAB+4	JSR BLOCKD	; BLOCK	LDA ALTAB+1	CLC	ADC ADX	STA ALTAB+1	LDA ALTAB+2	CLC	ADC ADY	STA ALTAB+2	INC ALTAB+3	LDA ALTAB+3	CMP ALTAB	BCC AL1 	PLA	TAX	PLA	TAY	PLA	RTSDOWN:	JSR ADSAVE	PHA	TYA	PHA	TXA	PHA	LDA #0	STA ADX	LDA #1	STA ADY	JMP ALDO ALONG:	JSR ADSAVE	PHA	TYA	PHA	TXA	PHA	LDA #2	STA ADX	LDA #0	STA ADY	JMP ALDOADSAVE:	STA ALTAB	STX ALTAB+1	STY ALTAB+2	RTSBLSPRITE	EQU ALTAB+4	EXTEND ':2.R.SCREEN'